<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Parine sa Batangas</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <style>
        {% load static %}

        @font-face {
          font-family: 'Batangas';
          src: url('{% static "Batangas Bold 700.ttf" %}') format('ttf');
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Batangas';
        }

        .scrollbar {
            max-height: 650px;
            overflow-y: auto;
            display: block;
        }

        .scrollbar::-webkit-scrollbar {
            width: 8px;
        }

        .scrollbar::-webkit-scrollbar-thumb {
            background-color: #888;
            border-radius: 4px;
        }

        .scrollbar::-webkit-scrollbar-track {
            background-color: #f2f2f2;
        }

        .edit-icon,
        .delete-icon {
            color: #fff;
            cursor: pointer;
            font-size: 15px;
            background-color: #15375D;
            border: 1px solid transparent;
            /* Add border to maintain circular shape */
            border-radius: 50%;
            /* Make it circular */
            width: 30px;
            /* Set width and height to make it a circle */
            height: 30px;
            /* Set width and height to make it a circle */
            display: flex;
            align-items: center;
            justify-content: center;
            float: left;


        }

        .edit-icon:hover {
            color: lightgreen;
        }

        .delete-icon {
            margin-left: 15px;
        }

        .delete-icon:hover {
            color: red;
        }

        /* Add styles for delete icon */
        .delete-icon {
            left: 60px;
            /* Position the delete icon on the right side */
        }

        .add-container input[type="text"],
        .add-container input[type="file"],
        .add-container textarea,
        .add-container button {
            margin-bottom: 20px;
            /* Add margin bottom to create space between inputs */
        }

        .add-container input[type="text"] {
            width: 100%;
            height: 30px;
        }

        .add-container textarea {
            width: 100%;
            /* Full width */
            height: 180px;
            resize: none;
            /* Allows vertical resize, none to disable resize */
        }

        .add-container {
            position: absolute;
            z-index: 999;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 40px 20px;
            border: 1px solid #0f172a;
            top: 50%;
            left: 47.2%;
            transform: translate(-50%, -50%);
            display: flex;
            flex-direction: column;
            /* Stack child elements vertically */
            align-items: stretch;
            /* Stretch child elements to container width */
        }

        .add-container button {
            position: absolute;
            left: 0;
            right: 0;
            margin: auto;
            height: 30px;
            width: 100px;
            cursor: pointer;
            /* Center the button horizontally */
        }

        .edit-container input[type="text"],
        .edit-container input[type="file"],
        .edit-container textarea,
        .edit-container button {
            margin-bottom: 10px;

        }

        .edit-container textarea {
            width: 100%;
            /* Full width */
            height: 120px;
            resize: none;
            /* Allows vertical resize, none to disable resize */
        }


        .edit-container input[type="text"] {
            width: 100%;
            height: 30px;
        }


        .edit-container {
            position: absolute;
            z-index: 1;
            height: 350px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 40px 20px;
            border: 1px solid #0f172a;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: flex;
            flex-direction: column;
            /* Stack child elements vertically */
            align-items: stretch;
            /* Stretch child elements to container width */
        }

        .edit-container button {
            height: 30px;
            width: 100px;
            cursor: pointer;
            left: 0;
            right: 0;
            margin: auto;

        }

        .delete-container {
            position: absolute;
            z-index: 1;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 20px;
            border: 1px solid #0f172a;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            /* Center the container */
            width: 270px;
            /* Set max width to match edit container */
        }

        .delete-container p {
            margin-bottom: 15px;
            /* Add some space between text and buttons */
        }

        .delete-container button {
            height: 30px;
            width: calc(50% - 5px);
            /* Set width of buttons to 50% minus 5px for space */
        }

        .delete-container .delete-yes {
            float: left;
            /* Align "Yes" button to the left */
        }

        .delete-container .delete-no {
            float: right;
            /* Align "No" button to the right */
        }



        .container {
            position: relative;
            /* Make the container relative for absolute positioning */
            display: flex;
            flex-wrap: wrap;
            justify-content: flex-start;
            padding: 20px 80px 80px 80px;
            margin-left: 20px;
            max-width: calc(100% - 40px);

        }

        .tourist-place {
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin: 10px;
            margin-bottom: 20px;
            width: 300px;
            padding: 20px;
            border: 1px solid #0f172a;
            position: relative;
            transition: transform 0.3s ease;
            overflow: hidden;
        }



        .tourist-place:hover {
            transform: translateY(-5px);
        }

        .tourist-place img {
            border: 1px solid #0f172a;
            margin-top: 10px;
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 10px;
            justify-content: center;
        }

        .tourist-place h2 {
            margin-top: 10px;
            font-size: 24px;
            color: #15375D;
            word-wrap: break-word;
            white-space: pre-wrap;


        }

        .tourist-place p {
            max-height: 150px;
            overflow-y: auto;
            padding-right: 8px;
            margin-top: 10px;

            font-size: 16px;
            color: #666;
            position: relative;
            word-wrap: break-word;
            text-align: justify;
        }

        .hidden {
            display: none;
        }


        .add-icon {
            position: fixed;
            bottom: 35px;
            right: 150px;
            font-size: 40px;
            color: #15375D;
            cursor: pointer;
            z-index: 1000;
            /* Increase the z-index */
            background-color: #15375D;
            border: 1px solid #0f172a;
            color: white;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .add-icon:hover {
            color: lightskyblue;
        }

        .add-icon.active {
            color: lightskyblue;
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- Add a hidden edit container inside each quiz div -->
        {% for question in questions %}
        <div class="tourist-place">


            <div class="edit-container hidden">
                <form method="post" action="{% url 'save_quiz_changes' %}" enctype="multipart/form-data">
                    {% csrf_token %}
                    <input type="hidden" name="quiz_id" value="{{ question.TriviaQuestionID }}">
                    <input type="hidden" name="quiz_name" value="{{ question.Municipality }}">
                    <label for="new_quiz_image">Upload New Quiz Image:</label>
                    <input type="file" id="new_quiz_image" name="image_file"><br>
                    <label for="new_quiz_file">Quiz File:</label>
                    {% if question.QuestionContent %}
                    <textarea id="new_quiz_file" name="new_quiz_file" class="scrollbar"
                        rows="4">{{  question.QuestionContent }}</textarea><br>
                    {% else %}
                    <textarea type="text" id="new_quiz_file" name="new_quiz_file" value="None"></textarea>
                    {% endif %}
                    <button type="submit">Save Changes</button>
                </form>
            </div>
            <div class="delete-container hidden">
                <form method="post" action="{% url 'delete_quiz' %}">
                    {% csrf_token %}
                    <input type="hidden" name="quiz_id" value="{{ question.TriviaQuestionID }}">
                    <p>Are you sure you want to delete this quiz?</p>
                    <button type="submit" class="delete-yes">Yes</button>
                    <button type="button" class="delete-no">No</button>
                </form>
            </div>
            <i class="fas fa-edit edit-icon" title="Edit"></i>
            <i class="fas fa-trash delete-icon" title="Delete"></i>
            <img src="{{ question.Images.url }}" alt="{{ question.Municipality }}">
            <h2>{{ question.Municipality }}</h2>
            <p class="scrollbar">{{ question.QuestionContent }}</p>

        </div>
        {% endfor %}
    </div>
    <div class="add-container hidden">
        <form method="post" action="{% url 'add_quiz' %}" enctype="multipart/form-data">
            {% csrf_token %}
            <!-- Include input field for municipality name -->
            <input type="hidden" id="quiztype" name="quiztype" value="module_tourist">
            <label for="new_quiz_image">Upload Quiz Image:</label>
            <input type="file" id="new_quiz_image" name="new_quiz_image" required><br>
            <label for="new_quiz_municipality">Quiz Municipality:</label>
            <input type="text" id="municipality_name" name="municipality_name" value="municipality_name" readonly><br>
            <label for="new_quiz_file">Quiz Content:</label>
            <textarea id="new_quiz_file" name="new_quiz_file" class="scrollbar" rows="10"></textarea><br>
            <button type="submit">Add Quiz</button>
        </form>
    </div>
    <i class="fas fa-plus add-icon" title="Add Quiz"></i>
    <script>
        document.addEventListener('DOMContentLoaded', function () {

            function hideAllDeleteContainers() {
                document.querySelectorAll('.delete-container').forEach(deleteContainer => {
                    deleteContainer.classList.add('hidden');
                });
            }

            // Function to hide all edit containers
            function hideAllEditContainers() {
                document.querySelectorAll('.edit-container').forEach(editContainer => {
                    editContainer.classList.add('hidden');
                });
            }

            // Function to hide the add container
            function hideAddContainer() {
                document.querySelector('.add-container').classList.add('hidden');
            }
            // Function to toggle active class on add icon
            function toggleAddIconActive() {
                const addIcon = document.querySelector('.add-icon');
                addIcon.classList.toggle('active');
            }
            // Event listener for the add icon
            document.querySelector('.add-icon').addEventListener('click', function () {
                // Hide all edit containers
                hideAllEditContainers();

                // Hide all delete containers
                hideAllDeleteContainers();

                // Check if the add container is currently visible
                const addContainer = document.querySelector('.add-container');
                const isVisible = !addContainer.classList.contains('hidden');

                if (isVisible) {
                    // If the add container is already visible, hide it
                    hideAddContainer();
                    document.querySelector('.add-icon').classList.remove('active');
                } else {
                    // If the add container is not visible, show it
                    addContainer.classList.remove('hidden');
                    toggleAddIconActive();
                }
            });

            // Event listener for clicking outside the add container, edit container, or delete container
            document.addEventListener('click', function (event) {
                const target = event.target;
                const isAddIcon = target.classList.contains('add-icon');
                const isAddContainer = target.closest('.add-container');
                const isEditIcon = target.classList.contains('edit-icon');
                const isEditContainer = target.closest('.edit-container');
                const isDeleteIcon = target.classList.contains('delete-icon');
                const isDeleteContainer = target.closest('.delete-container');

                if (!isAddIcon && !isAddContainer && !isEditIcon && !isEditContainer && !isDeleteIcon && !isDeleteContainer) {
                    // Hide the add container if clicked outside
                    hideAddContainer();

                    // Hide all edit containers
                    hideAllEditContainers();

                    // Hide all delete containers
                    hideAllDeleteContainers();
                    document.querySelector('.add-icon').classList.remove('active');
                }
            });

            // Event listener for edit icons
            document.querySelectorAll('.edit-icon').forEach(icon => {
                icon.addEventListener('click', function (event) {
                    event.stopPropagation(); // Prevent event bubbling

                    // Hide all delete containers
                    hideAllDeleteContainers();

                    // Hide the add container
                    hideAddContainer();
                    document.querySelector('.add-icon').classList.remove('active');
                    // Hide all other edit containers
                    hideAllEditContainers();

                    const container = this.parentNode;
                    const editContainer = container.querySelector('.edit-container');
                    editContainer.classList.remove('hidden');

                    // Get current quiz data
                    const quizname = container.querySelector('h2').textContent;
                    const quizimage = container.querySelector('img').src;
                    const quizcontent = container.querySelector('p').textContent;

                    // Fill edit container with current quiz data
                    editContainer.querySelector('#new_quiz_municipality').value = quizname;
                    editContainer.querySelector('#new_quiz_image').value = quizimage;
                    editContainer.querySelector('#new_quiz_file').value = quizcontent;
                });
            });

            // Event listener for delete icons
            document.querySelectorAll('.delete-icon').forEach(icon => {
                icon.addEventListener('click', function (event) {
                    event.stopPropagation(); // Prevent event bubbling

                    // Hide all edit containers
                    hideAllEditContainers();
                    document.querySelector('.add-icon').classList.remove('active');
                    // Hide the add container
                    hideAddContainer();

                    const container = this.parentNode;
                    const deleteContainer = container.querySelector('.delete-container');

                    // Hide all other delete containers
                    hideAllDeleteContainers();

                    deleteContainer.classList.remove('hidden');
                });
            });

            // Event listener for "No" button in delete container
            document.querySelectorAll('.delete-no').forEach(button => {
                button.addEventListener('click', function (event) {
                    event.stopPropagation(); // Prevent event bubbling

                    // Hide the delete container
                    this.closest('.delete-container').classList.add('hidden');
                });
            });
        });

        document.addEventListener('DOMContentLoaded', function () {
            // Retrieve the selected district name from sessionStorage
            const selectedDistrict = sessionStorage.getItem('selectedDistrict');
            if (selectedDistrict) {
                // Store the selected district name as the municipality name
                document.getElementById('municipality_name').value = selectedDistrict;
            }
        });
    </script>
</body>

</html>